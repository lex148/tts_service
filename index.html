
<html>
  <head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
  </head>

  <body>

    <script type="text/javascript">

      $(function(){
        $('#read').click(function(){
          read_tts();
        });
      });

      function read_tts(){
        $.ajax({
            url: 'read',
            type: 'POST',
            data: {"text": $('#text_to_read').val() } ,
            success: function(data){
              $('#playback').html('<audio controls="controls" ><source type="audio/mp3" src="' + data +'" ></audio>');
              $('#playback audio')[0].play();
              cleanup_tts(data);
              }
          });
      }

      function cleanup_tts(data){
        $.ajax({
            url:'cleanup/' + data.match(/audio\/(\w+\.\w+)/)[1],
            type: 'POST'
          }); 
      }
    
    </script>

    <div> 
      <form action="./out.mp3" method="post">
        <input type="text" id='text_to_read' />
        <input type="button" id="read" value="Read" />
      </form>
      <div id="playback">
        <audio controls="controls"></audio>
      </div>
    </div>

    <iframe src="http://www.google.com" width='100%' height='100%' />

  </body>
</html>

